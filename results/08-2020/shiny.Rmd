---
title: "FIM Update Summary"
runtime: shiny
output:
  html_document:
    df_print: paged
---
```{r, setup, include = FALSE}
knitr::opts_chunk$set( warning = FALSE, message = FALSE, echo = FALSE)
```


```{r, include = FALSE}
library(tidyverse)
library(stringr)
library(reshape2)
library(rmarkdown)
library(TTR)
library(data.table)
library(DataExplorer)
library(shiny)
library(rsconnect)
```

The purpose of this document is to document changes between the previous FIM update and the most recent one. 


## Previous FIM

### Table 


The table below shows our FIM projections on 08/04/2020:
```{r cars}
fim_08.2020 <- read_csv("08-2020/fim-projections-2020-08-04.csv") 
fim_08.2020 <- fim_08.2020 %>% select(-X1) %>% filter(date > "2019-12-31")  %>% mutate_if(is.numeric, round, 2)
fim_08.2020$date <- as.Date(fim_08.2020$date)

library(DT)
DT::datatable(fim_08.2020, class = "cell-border stripe", rownames = F, editable = TRUE, extensions = 'Buttons', options = list(
  dom = 'Bfrtip',
  buttons = c('copy', 'csv', 'excel', 'pdf', 'print')))
```


### Plots


It may also be helpful to visualize these projections. 
```{r, echo = FALSE}
inputPanel(
selectInput(inputId = "yaxis",label = "Y-axis",choices = names(fim_08.2020)[-1])
)

renderPlot({
  ggplot(fim_08.2020, aes_string("date", input$yaxis)) + geom_line() 
})
```

## Updated FIM

In the second estimate, real GDP decreased 31.7 percent in the second quarter, an upward revision of 1.2 percentage points from the previous estimate issued last month. The revision primarily reflected upward revisions to private inventory investment and PCE.

Specifically,

* Q1 Revisions
  + Wages and Salaries
    - BEA revised estimates of first-quarter wages and salaries, personal taxes, and contributions for government social insurance, based on updated data from the BLS Quarterly Census of Employment and Wages program. 
    - Wages and salaries are now estimated to have increased $103.6 billion in the first quarter of 2020, a downward revision of $3.4 billion. 
    
* Q2 Revisions
  + Real GDP
    - Decreased 31.7 percent (upward revision of 1.2 percentage points)
    - Reflects upward revisions to private inventory investment and PCE
  + Corporate profits
    - Profits from current production decreased $226.9 billion in Q2 (Q1 decrease was $276.2 billion)
    - Profits of domestic financial corporations increased $39.5 billion (Q1 decrease was $42.2 billion)
    - Profits of domestic nonfinancial corporations decreased $170.1 billion (Q1 decrease was $190.5 billion)
    - Rest-of-the-world profits decreased $96.2 billion (Q1 decrease was $43.5 billion)





\n 


### Table


```{r}
fim <- read_csv("08-2020/fim-projections-2020-08-28.csv") 
fim <- fim %>% select(-X1)
fim <- fim %>% filter(date > "2019-12-31") %>% mutate_if(is.numeric, round, 2)

DT::datatable(fim, class = "cell-border stripe", rownames = F, editable = TRUE, extensions = 'Buttons', options = list(
  dom = 'Bfrtip',
  buttons = c('copy', 'csv', 'excel', 'pdf', 'print')))
```


### Plots



```{r, echo = FALSE}
inputPanel(
selectInput(inputId = "yaxis",label = "Y-axis",choices = names(fim)[-1])
)

renderPlot({
  ggplot(fim, aes_string("date", input$yaxis)) + geom_line() 
})
```

## September FIM


### Table


```{r}
fim_09 <- read_csv("09-2020/fim-projections-2020-09-04.csv") 
fim_09 <- fim %>% select(-X1)
fim_09 <- fim %>% filter(date > "2019-12-31") %>% mutate_if(is.numeric, round, 2)

DT::datatable(fim_09, class = "cell-border stripe", rownames = F, editable = TRUE, extensions = 'Buttons', options = list(
  dom = 'Bfrtip',
  buttons = c('copy', 'csv', 'excel', 'pdf', 'print')))
```


### Plots



```{r, echo = FALSE}
inputPanel(
selectInput(inputId = "yaxis",label = "Y-axis",choices = names(fim)[-1])
)

renderPlot({
  ggplot(fim_09, aes_string("date", input$yaxis)) + geom_line() 
})
```



## Difference in projections





```{r, include = FALSE}
fim_new <- fim_09 %>% mutate(id = "Updated") %>% filter(date > "2019-12-31") %>% mutate_if(is.numeric, round, 2)
fim_old <- fim %>% mutate(id = "Previous") %>% filter(date > "2019-12-31") %>% mutate_if(is.numeric, round, 2)

fim_both <- rbind(fim_old, fim_new) %>% group_by(id, date)
fim_diff <- fim_09 - fim 
fim_diff <- fim_diff %>% mutate_if(is.numeric, round, 2) %>% mutate(date = fim$date)

```

```{r}
DT::datatable(fim_diff, class = "cell-border stripe", rownames = F, editable = TRUE, extensions = 'Buttons', options = list(
  dom = 'Bfrtip',
  buttons = c('copy', 'csv', 'excel', 'pdf', 'print')))
```


We can also visualize both FIM's side by side


```{r both, echo = FALSE}
inputPanel(
selectInput(inputId = "yaxis",label = "Y-axis",choices = names(fim_both)[-1])
)

renderPlot({
  ggplot(fim_both, aes_string("date", input$yaxis, group = "id", color = "id")) + geom_line() 
})
```


